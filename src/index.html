<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Test-Browser</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body { 
      height: 100%; 
      margin: 0; 
    }
    
    body { 
      display: flex;
      flex-direction: column;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background-color: #f5f5f5;
    }
    
    #titlebar { 
      background: linear-gradient(to bottom, #e8e8e8, #d0d0d0);
      padding: 6px 12px;
      border-bottom: 1px solid #b8b8b8;
      font-size: 13px;
      font-weight: 500;
      color: #333;
    }
    
    #nav { 
      background: linear-gradient(to bottom, #f0f0f0, #e0e0e0);
      padding: 6px 8px;
      display: flex;
      gap: 6px;
      border-bottom: 1px solid #b8b8b8;
      align-items: center;
    }
    
    #nav button {
      padding: 4px 8px;
      border: 1px solid #b8b8b8;
      border-radius: 3px;
      background: linear-gradient(to bottom, #f8f8f8, #e8e8e8);
      font-size: 14px;
      cursor: pointer;
      min-width: 28px;
    }
    
    #nav button:hover {
      background: linear-gradient(to bottom, #e8e8e8, #d8d8d8);
    }
    
    #nav button:active {
      background: linear-gradient(to bottom, #d0d0d0, #e0e0e0);
    }
    
    #nav button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      background: linear-gradient(to bottom, #f0f0f0, #e8e8e8);
    }
    
    #nav button:disabled:hover {
      background: linear-gradient(to bottom, #f0f0f0, #e8e8e8);
    }
    
    #nav input {
      flex: 1;
      padding: 4px 8px;
      border: 1px solid #b8b8b8;
      border-radius: 3px;
      font-size: 13px;
      background: white;
    }
    
    #nav input:focus {
      outline: none;
      border-color: #4a90e2;
      box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2);
    }
    
    #webview { 
      flex: 1;
      width: 100%; 
      border: none;
      display: block;
    }
  </style>
</head>
<body>
  <div id="titlebar">Test-Browser - [ページのタイトル]</div>
  <div id="nav">
    <button id="back-btn" title="戻る">&larr;</button>
    <button id="forward-btn" title="進む">&rarr;</button>
    <button id="reload-btn" title="再読み込み">&#x21bb;</button>
    <input id="url-input" type="text" value="https://github.com/" placeholder="URLを入力" />
  </div>
  <webview id="webview" src="https://github.com/" allowpopups></webview>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const webview = document.getElementById('webview');
      const backBtn = document.getElementById('back-btn');
      const forwardBtn = document.getElementById('forward-btn');
      const reloadBtn = document.getElementById('reload-btn');
      const urlInput = document.getElementById('url-input');
      const titlebar = document.getElementById('titlebar');

      // Initialize button states
      function updateNavigationButtons() {
        backBtn.disabled = !webview.canGoBack();
        forwardBtn.disabled = !webview.canGoForward();
      }

      // Handle address bar navigation
      urlInput.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
          let url = urlInput.value.trim().toLowerCase();
          if (url) {
            // Add protocol if missing
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
              url = 'https://' + url;
            }
            webview.src = url;
          }
        }
      });

      // Navigation button handlers
      backBtn.addEventListener('click', function() {
        if (webview.canGoBack()) {
          webview.goBack();
        }
      });

      forwardBtn.addEventListener('click', function() {
        if (webview.canGoForward()) {
          webview.goForward();
        }
      });

      reloadBtn.addEventListener('click', function() {
        webview.reload();
      });

      // WebView event listeners
      webview.addEventListener('dom-ready', function() {
        updateNavigationButtons();
      });

      webview.addEventListener('did-navigate', function(event) {
        urlInput.value = event.url;
        updateNavigationButtons();
      });

      webview.addEventListener('did-navigate-in-page', function(event) {
        urlInput.value = event.url;
        updateNavigationButtons();
      });

      webview.addEventListener('page-title-updated', function(event) {
        titlebar.textContent = `Test-Browser - ${event.title}`;
      });

      // Initial state
      updateNavigationButtons();
    });
  </script>
</body>
</html>
